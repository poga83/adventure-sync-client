<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventure Sync</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/trip-planning.css">
    <link rel="icon" href="icon/favicon.ico" type="image/x-icon">
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.socket.io/4.7.0/socket.io.min.js"></script>
</head>
<body>
    <div id="app" class="hidden">
        <header class="app-header">
            <h1>Adventure Sync</h1>
            <div class="header-controls">
                <span id="userNickname" class="user-nickname"></span>
                <button id="chatToggle" class="action-btn" title="–ß–∞—Ç">
                    <i class="fas fa-comments"></i>
                </button>
                <button id="tripPlanningBtn" class="trip-planning-btn" title="–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏">
                    <i class="fas fa-route"></i>
                </button>
                <button id="logoutBtn" class="logout-btn" title="–í—ã—Ö–æ–¥">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </header>

        <div class="map-wrapper">
            <div id="map"></div>
            <div id="connectionStatus" class="connection-status">
                <i class="fas fa-spinner fa-spin"></i>
                <span>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ‚Ä¶</span>
            </div>
        </div>

        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —á–∞—Ç–∞ -->
        <div id="chatSidebar" class="sidebar">
            <div class="sidebar-content">
                <div class="chat-section">
                    <h3>–ß–∞—Ç</h3>
                    <div id="messagesContainer" class="messages-container"></div>
                    <div class="message-input-container">
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="500">
                        <button id="sendMessageBtn" class="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
                
                <div class="users-section">
                    <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ –æ–Ω–ª–∞–π–Ω</h3>
                    <div id="usersList" class="users-list"></div>
                </div>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–µ–∑–¥–∫–∏ -->
        <div id="tripPlanningPanel" class="trip-planning-panel hidden">
            <div class="trip-panel-content">
                <div class="trip-header">
                    <h2>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏</h2>
                    <button id="closeTripPanel" class="close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="trip-form">
                    <div class="form-group">
                        <label for="tripName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏</label>
                        <input type="text" id="tripName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏">
                    </div>
                    
                    <div class="form-group">
                        <label for="tripDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="tripDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏..."></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startDate">–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞</label>
                            <input type="date" id="startDate">
                        </div>
                        <div class="form-group">
                            <label for="endDate">–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è</label>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>–¢–æ—á–∫–∞ —Å–±–æ—Ä–∞</label>
                        <button id="setGatheringPointBtn" class="action-btn">
                            <i class="fas fa-map-marker-alt"></i>
                            –í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
                        </button>
                        <div id="gatheringPointInfo" class="gathering-point-info hidden">
                            <i class="fas fa-check-circle"></i>
                            <span>–¢–æ—á–∫–∞ —Å–±–æ—Ä–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞</span>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button id="createTripBtn" class="primary-btn">
                            <i class="fas fa-plus"></i>
                            –°–æ–∑–¥–∞—Ç—å –ø–æ–µ–∑–¥–∫—É
                        </button>
                    </div>
                </div>
                
                <div class="trips-list">
                    <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–µ–∑–¥–∫–∏</h3>
                    <div id="activeTrips" class="trips-container"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2>Adventure Sync</h2>
            <p>–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ</p>
            
            <form id="loginForm">
                <div class="form-group">
                    <label for="nickname">–ù–∏–∫–Ω–µ–π–º</label>
                    <input type="text" id="nickname" required minlength="2" maxlength="20">
                    <div id="nicknameError" class="error-message hidden"></div>
                </div>
                
                <div class="form-group">
                    <label for="status">–°—Ç–∞—Ç—É—Å</label>
                    <select id="status" required>
                        <option value="auto">üöó –ê–≤—Ç–æ</option>
                        <option value="moto">üèç –ú–æ—Ç–æ</option>
                        <option value="walking">üö∂ –ü–µ—à–∫–æ–º</option>
                        <option value="busy">üö´ –ó–∞–Ω—è—Ç</option>
                    </select>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    –í–æ–π—Ç–∏
                </button>
            </form>
        </div>
    </div>

    <div id="notificationsContainer" class="notifications-container"></div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
